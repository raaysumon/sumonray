<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RayVid ‚Äî Watch Smarter</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Adsense -->
<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->

<style>
body{margin:0;font-family:Inter,Arial;background:#0f0f0f;color:#fff}
header{display:flex;align-items:center;justify-content:space-between;
padding:10px 20px;background:#121212;position:sticky;top:0;z-index:9}
.logo{font-size:22px;font-weight:700;color:#ff0000}
#user img{border-radius:50%;vertical-align:middle}
#grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
gap:20px;padding:20px}
.card{background:#181818;border-radius:12px;overflow:hidden;cursor:pointer}
.card iframe{width:100%;height:170px;border:none}
.meta{padding:10px}
.meta h4{margin:5px 0;font-size:16px}
.meta p{font-size:13px;color:#aaa}
.stats{font-size:12px;color:#888}
button{background:#ff0000;color:#fff;border:none;
padding:6px 12px;border-radius:6px;cursor:pointer}
</style>
</head>

<body>

<header>
  <div class="logo">‚ñ∂ RayVid</div>
  <div id="user"></div>
</header>

<section id="grid"></section>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey: "AIzaSyAoZdkD0PZz25lIVrNy3hQE2fBrkHELs2Q",
 authDomain: "rayvid-c074a.firebaseapp.com",
 projectId: "rayvid-c074a"
});

const auth = firebase.auth();
const db = firebase.firestore();

/* ---------- AUTH ---------- */
auth.onAuthStateChanged(user=>{
 if(user){
   document.getElementById("user").innerHTML=
    `<img src="${user.photoURL}" width="32"> ${user.displayName}
     <button onclick="logout()">Logout</button>`;
   db.collection("users").doc(user.uid).set({
     name:user.displayName,
     email:user.email,
     photo:user.photoURL
   },{merge:true});
 }else{
   document.getElementById("user").innerHTML=
    `<button onclick="login()">Login</button>`;
 }
});

function login(){
 auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
}
function logout(){auth.signOut();}

/* ---------- VIDEOS ---------- */
db.collection("videos")
.orderBy("createdAt","desc")
.onSnapshot(snap=>{
 const grid=document.getElementById("grid");
 grid.innerHTML="";
 snap.forEach(doc=>{
  const v=doc.data();
  grid.innerHTML+=`
   <div class="card" onclick="view('${doc.id}')">
    <iframe src="https://drive.google.com/file/d/${v.driveId}/preview"></iframe>
    <div class="meta">
      <h4>${v.title}</h4>
      <p>${v.description}</p>
      <div class="stats">üëÅ ${v.views||0} ¬∑ üëç ${v.likes||0}</div>
    </div>
   </div>`;
 });
});

function view(id){
 db.collection("videos").doc(id)
 .update({views:firebase.firestore.FieldValue.increment(1)});
}
</script>
</body>
</html>
