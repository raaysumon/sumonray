<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RayVid Admin | Review Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-[#0a0a0a] text-white p-6 md:p-12">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-10 border-b border-gray-800 pb-6">
            <h1 class="text-3xl font-black italic">ADMIN PANEL</h1>
            <a href="rayvid.html" class="text-gray-400 hover:text-white transition text-sm">View Website â†’</a>
        </header>

        <h2 class="text-xl font-bold mb-6 text-yellow-500"><i class="fa-solid fa-hourglass-half mr-2"></i>Pending Review</h2>
        <div id="admin-list" class="grid gap-4">
            </div>
    </div>

    <script>
        const firebaseConfig = { /* SAME AS ABOVE */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        db.collection("pending_videos").onSnapshot(snap => {
            const list = document.getElementById('admin-list');
            list.innerHTML = snap.empty ? '<p class="text-gray-600">No new submissions.</p>' : '';
            snap.forEach(doc => {
                const data = doc.data();
                list.innerHTML += `
                    <div class="bg-[#161616] p-6 rounded-2xl border border-gray-800 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div>
                            <h3 class="text-lg font-bold">${data.title}</h3>
                            <p class="text-sm text-gray-500">Submitted by: <span class="text-blue-400">${data.userName}</span></p>
                            <a href="${data.url}" target="_blank" class="text-xs text-red-500 hover:underline">Preview Link</a>
                        </div>
                        <div class="flex gap-2 w-full md:w-auto">
                            <button onclick="action('${doc.id}', true)" class="flex-1 md:flex-none bg-green-600 hover:bg-green-500 px-6 py-2 rounded-lg font-bold text-sm transition">Approve</button>
                            <button onclick="action('${doc.id}', false)" class="flex-1 md:flex-none bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white px-6 py-2 rounded-lg font-bold text-sm transition">Reject</button>
                        </div>
                    </div>`;
            });
        });

        async function action(id, isApprove) {
            const ref = db.collection("pending_videos").doc(id);
            if(isApprove) {
                const doc = await ref.get();
                await db.collection("videos").add(doc.data());
            }
            await ref.delete();
        }
    </script>
</body>
</html>
